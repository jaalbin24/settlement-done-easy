<div class="container">
    <div class="row">
        <div class="col">
            <div class="card">
                <h3 class="text-center card-header">Document Info</h3>
                <div class="card-body bg-dark">
                    <div class="container">
                        <div class="row">
                            <div class="col text-end">
                                Filename:
                            </div>
                            <div class="col">
                                <%=@document.pdf.filename%>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col text-end">
                                Added by:
                            </div>
                            <div class="col">
                                <%=@document.added_by.full_name%>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col text-end">
                                Date added:
                            </div>
                            <div class="col">
                                <%=@document.created_at.in_time_zone("Central Time (US & Canada)").strftime("%B %-d, %Y")%>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col text-end">
                                Signature:
                            </div>
                            <div class="col">
                                <%if @document.signed?%>
                                    <td>✔️</td>
                                <%elsif @document.ds_envelope_id != nil%>
                                    <td>⌛</td>
                                <%else%>
                                    <td>❌</td>
                                <%end%>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col text-end">
                                Approval:
                            </div>
                            <div class="col">
                                <%if @document.approved?%>
                                    ✔️
                                <%elsif @document.rejected?%>
                                    ❌
                                <%else%>
                                    ⌛
                                <%end%>
                            </div>
                        </div>
                    </div>
                </div>
                <%if !@document.approved? && !@document.rejected?%>
                <h3 class="text-center card-header">Approve or Reject</h3>
                <div class="card-body bg-dark">
                    <div class="row text-center">
                        <div class="col">
                            <%=link_to "Approve", document_approve_path(@document), method: :post, class: "btn btn-lg btn-success w-100"%>
                        </div>
                        <div class="col">
                            <%=link_to "Reject", document_reject_path(@document), method: :post, class: "btn btn-lg btn-danger w-100"%>
                        </div>
                    </div>
                    <h6 class="mt-2 mb-0 text-center">Once approved/rejected, the document cannot be modified.</h6>
                </div>
                <%end%>
                <%if !@document.signed?%>
                <h3 class="text-center card-header">Get eSignature</h3>
                <div class="card-body py-1">
                    <p class="card-text text-center"><%=@document.settlement.plaintiff_name%> will receive an email with instructions to eSign this document.</p>
                </div>
                <div class="card-body bg-dark">
                    <%= form_with url: document_send_ds_signature_request_path(@document), method: :patch, local: true do |f| %>
                        <div class="mb-3">
                            <%= f.label "Client name", { class: "form-label"} %>
                            <%= f.text_field :client_name, class: "form-control", placeholder: "Client name", value: @document.settlement.plaintiff_name, readonly: true%>
                        </div>
                        <div class="mb-3">
                            <%= f.label "Client email", { class: "form-label"} %>
                            <%= f.email_field :client_email, class: "form-control", placeholder: "Client email", autofocus: true, required: true%>
                        </div>
                        <div class="row">
                        <div class="col">
                                <%=link_to "Send Later", root_path, class: "btn btn-lg btn-secondary w-100"%>
                            </div>
                            <div class="col">
                                <%=f.submit "Send Now", class: "btn btn-lg btn-primary w-100"%>
                            </div>
                        </div>
                    <% end %>
                </div>
                <%end%>
            </div>
            <div class="mt-3 text-center">
                <%=link_to "Back to document index", document_index_path(@document.settlement), class: "btn btn-lg btn-primary"%>
            </div>
        </div>
        <div class="col">
            <embed src="<%=rails_blob_path(@document.pdf)%>" type="application/pdf"  width="100%" height="700" style="border: none;">
        </div>
    </div>
</div>
